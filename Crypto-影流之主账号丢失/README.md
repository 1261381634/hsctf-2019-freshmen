# 影 流 之 主 账 号 丢 失

## 概括

- 出题人：Payne
- 类型：Crypto
- 关键字：SM3、爆破
- Flag：`HSCTF{C00l_Sm3_Cr@cker}`

## 题目内容

影 流 之 主 丢了他的撸啊撸密码。
他懂一点密码学，在注册撸啊撸的时候对他的密码做了加密。
他隐隐约约记得备份密码是6个字符组成的，其中前2位是小写字母，后4位是数字。
下面是备份软件和恢复软件，宁可以帮他恢复撸啊撸密码吗？

## 目录结构

- src: 题目源代码
- wp: 破解工具

## Writeup

分析 backup 的源代码，可以发现：

恢复密码用SM3算出来的Hash作为真正密码的加密密钥，
加密密钥再算一次SM3得到tips。

我们爆破的时候只需要按照提示生成密码词典，
不断计算 SM3(SM3(password))，
只要计算得到的值与 tips 的值一致，
就说明我们找到恢复密码：`ng6324`。

此时只需要用recover工具解密就可以得到Flag。
